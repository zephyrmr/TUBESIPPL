// script.js
document.addEventListener('DOMContentLoaded', function() {
    const logoBtn = document.getElementById('logoBtn');
    const body = document.body;
    const landing = document.getElementById('landing');
    const hero = document.getElementById('hero');

    // Hide hero initially
    hero.style.display = 'none';

    // Circle click handler
    logoBtn.addEventListener('click', function() {
        // Start landing transition
        body.classList.add('entering');

        // Show hero after expansion animation completes (650ms)
        setTimeout(() => {
            hero.style.display = '';
            body.classList.remove('entering');
            body.classList.add('entered');
        }, 650);
    });

    // Keyboard accessibility
    logoBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            logoBtn.click();
        }
    });

    // Login Modal Handlers
    const loginModal = document.getElementById('loginModal');
    const btnLogin = document.querySelector('.btn-login');
    const modalClose = document.querySelector('.modal-close');
    const modalBackdrop = document.querySelector('.modal-backdrop');
    const loginForm = document.getElementById('loginForm');

    // Open login modal
    btnLogin.addEventListener('click', () => {
        loginModal.setAttribute('aria-hidden', 'false');
        body.style.overflow = 'hidden';
    });

    // Close login modal
    function closeLoginModal() {
        loginModal.setAttribute('aria-hidden', 'true');
        body.style.overflow = '';
    }

    modalClose.addEventListener('click', closeLoginModal);
    modalBackdrop.addEventListener('click', closeLoginModal);

    // Handle form submission
    loginForm.addEventListener('submit', (e) => {
        e.preventDefault();
        // Demo: just close the modal
        closeLoginModal();
    });

    // Close modal on ESC key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && loginModal.getAttribute('aria-hidden') === 'false') {
            closeLoginModal();
        }
    });

    // Forgot Password Modal Handlers
    const forgotPasswordModal = document.getElementById('forgotPasswordModal');
    const forgotPasswordClose = document.getElementById('forgotPasswordClose');
    const forgotPasswordForm = document.getElementById('forgotPasswordForm');
    const backToLoginLinks = document.querySelectorAll('.forgot-password, .back-to-login');

    // Open forgot password modal
    function openForgotPasswordModal() {
        loginModal.setAttribute('aria-hidden', 'true');
        forgotPasswordModal.setAttribute('aria-hidden', 'false');
    }

    // Close forgot password modal
    function closeForgotPasswordModal() {
        forgotPasswordModal.setAttribute('aria-hidden', 'true');
        body.style.overflow = '';
    }

    // Open from login modal
    document.querySelector('.forgot-password').addEventListener('click', (e) => {
        e.preventDefault();
        openForgotPasswordModal();
    });

    // Close handlers
    forgotPasswordClose.addEventListener('click', closeForgotPasswordModal);

    // Back to login button
    document.querySelector('.back-to-login').addEventListener('click', (e) => {
        e.preventDefault();
        closeForgotPasswordModal();
        loginModal.setAttribute('aria-hidden', 'false');
        body.style.overflow = 'hidden';
    });

    // Handle forgot password form submission
    forgotPasswordForm.addEventListener('submit', (e) => {
        e.preventDefault();
        // Demo: close modal after sending reset link
        closeForgotPasswordModal();
    });

    // Close on ESC key
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && forgotPasswordModal.getAttribute('aria-hidden') === 'false') {
            closeForgotPasswordModal();
        }
    });

    // Register Modal Handlers
    const registerModal = document.getElementById('registerModal');
    const registerClose = document.getElementById('registerClose');
    const registerForm = document.getElementById('registerForm');
    const btnRegist = document.querySelector('.btn-regist');

    // Open register modal
    btnRegist.addEventListener('click', () => {
        // hide any other auth modal
        loginModal.setAttribute('aria-hidden', 'true');
        forgotPasswordModal.setAttribute('aria-hidden', 'true');
        registerModal.setAttribute('aria-hidden', 'false');
        body.style.overflow = 'hidden';
    });

    // Close register modal
    function closeRegisterModal() {
        registerModal.setAttribute('aria-hidden', 'true');
        body.style.overflow = '';
    }

    // Close button
    registerClose.addEventListener('click', closeRegisterModal);

    // Back to login from register
    document.querySelector('.login-from-register').addEventListener('click', (e) => {
        e.preventDefault();
        closeRegisterModal();
        loginModal.setAttribute('aria-hidden', 'false');
        body.style.overflow = 'hidden';
    });

    // Register form submit (demo)
    registerForm.addEventListener('submit', (e) => {
        e.preventDefault();
        // Demo: close register and open login
        closeRegisterModal();
        loginModal.setAttribute('aria-hidden', 'false');
        body.style.overflow = 'hidden';
    });

    // Close register on ESC
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && registerModal.getAttribute('aria-hidden') === 'false') {
            closeRegisterModal();
        }
    });
});